<div id="subscription" class="top-buffer-1">
  <a ui-sref="home.subscriptions" class="text-muted">
    <i class="fa fa-chevron-left"></i>&nbsp;<span translate>mno_enterprise.templates.dashboard.provisioning.subscription.back</span>
  </a>

  <h2 class="text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.subscription_info</h2>

  <mno-loader ng-show="vm.isLoading" class="top-buffer-4"></mno-loader>
  <div ng-if="!vm.isLoading">
    <div class="row top-buffer-2">
      <!-- Left column -->
      <div class="col-sm-6">
        <div class="well subscription-info">
          <h3 class="text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.info</h3>
          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.product</label>
            <input class="form-control hide-border" ng-model="vm.subscription.product.name" readonly/>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.subscription_info</label>
            <input class="form-control hide-border" ng-model="vm.subscription.product_pricing.name" readonly/>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.description</label>
            <input class="form-control hide-border" ng-model="vm.subscription.product_pricing.description" readonly/>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.date</label>
            <div class="push-right">{{ vm.subscription.start_date | amDateFormat: 'L' }}</div>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.end_date</label>
            <div class="push-right">{{ vm.subscription.end_date | amDateFormat: 'L' }}</div>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.status</label>
            <input class="form-control hide-border" ng-model="vm.subscription.status" readonly/>
          </div>

          <div class="form-group" ng-show="vm.subscription.product_pricing.license_based">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.licenses</label>
            <input class="form-control hide-border" ng-model="vm.subscription.max_licenses" readonly/>
          </div>

          <div class="form-group">
            <label class="control-label text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.amount</label>
            <ul>
              <li ng-hide="vm.subscription.product_pricing.pricing_type == 'payg'" ng-repeat="price in vm.subscription.product_pricing.prices | filterBy: ['currency']: vm.subscription.currency">
                <span class="badge">{{ price.currency }} {{ price.price_cents / 100 }}</span>
                <span ng-show="vm.subscription.product_pricing.pricing_type == 'recurring'">
                  / {{ vm.subscription.product_pricing.per_unit }} / {{ vm.subscription.product_pricing.per_duration }}
                </span>
                <span ng-show="vm.subscription.product_pricing.pricing_type == 'payg'">
                  {{ 'mno_enterprise.templates.dashboard.provisioning.order.pricing_type.payg' | translate }}
                </span>
              </li>
            </ul>
          </div>
        </div>

        <div class="well subscription-events">
          <h3 class="text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.events</h3>
          <div ng-repeat="subscriptionEvent in vm.subscriptionEvents">
            <div class="row subscription-event">
              <div class="col-sm-2">{{ subscriptionEvent.created_at | amDateFormat: 'L' }}</div>
              <div class="col-sm-2">{{ subscriptionEvent.event_type }}</div>
              <div class="col-sm-2">{{ subscriptionEvent.status }}</div>
              <div class="col-sm-6">{{ subscriptionEvent.message }}</div>
            </div>

            <div class="row subscription-event-provisioning-data" ng-if="subscriptionEvent.provisioning_data">
              <div class="col-sm-10 col-sm-offset-2">
                <user-friendly-json-tree start-expanded="false" object="subscriptionEvent.provisioning_data" options="vm.jsonTreeSettings" root-name="vm.rootName"></user-friendly-json-tree>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right column -->
      <div class="col-sm-6">
        <div class="well">
          <h3 class="text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.provisioning_data</h3>
          <span ng-show="!vm.subscription.provisioning_data" translate>mno_enterprise.templates.dashboard.provisioning.subscription.no_provisioning_data</span>
          <json-formatter ng-show="vm.subscription.provisioning_data" open="2" json="vm.subscription.provisioning_data"></json-formatter>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="well">
          <h3 class="text-color" translate>mno_enterprise.templates.dashboard.provisioning.subscription.custom_data</h3>
          <span ng-show="!vm.subscription.custom_data" translate>mno_enterprise.templates.dashboard.provisioning.subscription.no_custom_data</span>
          <form name="vm.detailsForm" ng-show="vm.subscription.custom_data" sf-schema="vm.schema" sf-form="vm.form" sf-model="vm.subscription.custom_data" sf-options="{ formDefaults: { readonly: { true } }}"></form>
        </div>
      </div>
    </div>
  </div>
</div>
